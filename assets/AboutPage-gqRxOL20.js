import{r as e,j as s,B as a,a7 as r,U as t,a8 as n,W as o,i,a9 as l,P as c,a as d,aa as x,Y as u,O as h,ab as m,L as g,b as p,e as j,f as y,k as v,V as f,ac as b,D as w,ad as S,ae as k,t as C,u as q,v as I,w as E,x as P,F as z}from"./mui-B-hF9WY3.js";import{m as B,L as D}from"./index-Wy9Nz8NF.js";import"./react-Gmj5k1uE.js";import"./redux-CnoZvtk0.js";import"./router-C9K2MBDU.js";import"./crypto-gvjJMIro.js";const L=()=>{const[s,a]=e.useState({quota:null,lastSave:null,errors:[],isHealthy:!0,saving:!1}),r=e.useCallback(async()=>{try{const[e,s]=await Promise.all([B.healthCheck(),B.getStorageQuota()]),r=B.getItem("lastSave",!1),t=r?.timestamp?new Date(r.timestamp):null;a({quota:s,lastSave:t,errors:e.errors,isHealthy:e.isHealthy,saving:!1})}catch(e){a(e=>({...e,errors:[...e.errors,"Failed to refresh storage status"],isHealthy:!1}))}},[]),t=e.useCallback(async()=>{try{const e=B.exportData(),s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(s),r=document.createElement("a");return r.href=a,r.download=`seaborne-backup-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a),{success:!0,data:e}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown export error"}}},[]),n=e.useCallback(async e=>{try{return await B.importData(e),window.location.reload(),{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Unknown import error"}}},[]),o=e.useCallback(async()=>{try{return a(e=>({...e,saving:!0})),await r(),{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown save error"}}finally{a(e=>({...e,saving:!1}))}},[r]),i=e.useCallback(()=>{a(e=>({...e,errors:[]}))},[]);return e.useEffect(()=>{const e=e=>{const{error:s,type:r}=e.detail;a(e=>({...e,errors:[...e.errors,`${r}: ${s}`],isHealthy:!1}))},s=e=>{const{usage:s}=e.detail;a(e=>({...e,errors:[...e.errors,`Storage quota warning: ${s}% used`]}))};window.addEventListener("storage-error",e),window.addEventListener("storage-quota-warning",s),r();const t=setInterval(r,3e4);return()=>{window.removeEventListener("storage-error",e),window.removeEventListener("storage-quota-warning",s),clearInterval(t)}},[r]),{status:s,exportData:t,importData:n,forceSave:o,clearErrors:i,refreshStatus:r}},$=({compact:P=!1,showActions:z=!0})=>{const{status:B,exportData:$,forceSave:F,clearErrors:U,refreshStatus:M}=L(),{triggerFileSelect:R}=(()=>{const{importData:s}=L(),a=e.useCallback(async e=>{try{if(!e.type.includes("json"))return{success:!1,error:"Please select a JSON file"};const a=await e.text(),r=JSON.parse(a);return await s(r)}catch(a){return{success:!1,error:a instanceof Error?a.message:"Invalid file format"}}},[s]),r=e.useCallback(()=>new Promise(e=>{const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=async s=>{const r=s.target.files?.[0];if(r){const s=await a(r);e(s)}else e({success:!1,error:"No file selected"})},s.oncancel=()=>{e({success:!1,error:"File selection cancelled"})},s.click()}),[a]);return{handleFileSelect:a,triggerFileSelect:r}})(),[T,W]=e.useState({open:!1,type:null,title:"",message:""}),H=()=>B.quota?B.quota.usagePercentage>90?"error":B.quota.usagePercentage>70?"warning":"success":"info",O=e=>{if(0===e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,s)).toFixed(2))} ${["B","KB","MB","GB"][s]}`},N=async()=>{try{const e=await F();e.success||alert(`Save failed: ${e.error}`)}catch(e){alert(`Save failed: ${e instanceof Error?e.message:"Unknown error"}`)}},A=(e,s,a)=>{W({open:!0,type:e,title:s,message:a})};return P?s.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[B.quota&&s.jsx(r,{title:`Storage: ${O(B.quota.used)} / ${O(B.quota.total)}`,children:s.jsx(t,{icon:s.jsx(n,{}),label:`${Math.round(B.quota.usagePercentage)}%`,color:H(),size:"small"})}),B.errors.length>0&&s.jsx(r,{title:`${B.errors.length} storage issue(s)`,children:s.jsx(t,{icon:s.jsx(o,{}),label:B.errors.length,color:"error",size:"small",onClick:U})}),s.jsx(r,{title:"Force save",children:s.jsx(i,{size:"small",onClick:N,disabled:B.saving,children:B.saving?s.jsx(D,{size:16}):s.jsx(l,{})})})]}):s.jsxs(c,{sx:{p:2},children:[s.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:2},children:[s.jsx(n,{sx:{mr:1}}),s.jsx(d,{variant:"h6",children:"Storage Management"}),s.jsx(a,{sx:{flexGrow:1}}),s.jsx(r,{title:"Refresh status",children:s.jsx(i,{onClick:M,size:"small",children:s.jsx(x,{})})})]}),B.quota&&s.jsxs(a,{sx:{mb:2},children:[s.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[s.jsx(d,{variant:"body2",color:"text.secondary",children:"Storage Usage"}),s.jsxs(d,{variant:"body2",children:[O(B.quota.used)," / ",O(B.quota.total)]})]}),s.jsx(u,{variant:"determinate",value:B.quota.usagePercentage,color:H(),sx:{height:8,borderRadius:4}}),s.jsxs(d,{variant:"caption",color:"text.secondary",children:[Math.round(B.quota.usagePercentage),"% used"]})]}),B.quota&&B.quota.usagePercentage>90&&s.jsxs(h,{severity:"error",sx:{mb:2},children:[s.jsx(m,{children:"Storage Nearly Full"}),"Storage is ",Math.round(B.quota.usagePercentage),"% full. Consider exporting your data and clearing old information."]}),B.quota&&B.quota.usagePercentage>70&&B.quota.usagePercentage<=90&&s.jsxs(h,{severity:"warning",sx:{mb:2},children:[s.jsx(m,{children:"Storage Getting Full"}),"Storage is ",Math.round(B.quota.usagePercentage),"% full. You may want to export your data as a backup."]}),B.errors.length>0&&s.jsxs(h,{severity:"error",sx:{mb:2},action:s.jsx(v,{color:"inherit",size:"small",onClick:U,children:"CLEAR"}),children:[s.jsxs(m,{children:["Storage Issues (",B.errors.length,")"]}),s.jsxs(g,{dense:!0,children:[B.errors.slice(0,3).map((e,a)=>s.jsxs(p,{sx:{py:0},children:[s.jsx(j,{sx:{minWidth:20},children:s.jsx(o,{fontSize:"small"})}),s.jsx(y,{primary:e})]},a)),B.errors.length>3&&s.jsxs(d,{variant:"caption",children:["...and ",B.errors.length-3," more"]})]})]}),s.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:2},children:[B.isHealthy?s.jsx(f,{color:"success",sx:{mr:1}}):s.jsx(b,{color:"warning",sx:{mr:1}}),s.jsxs(d,{variant:"body2",children:["System ",B.isHealthy?"Healthy":"Issues Detected"]}),B.lastSave&&s.jsxs(s.Fragment,{children:[s.jsx(w,{orientation:"vertical",flexItem:!0,sx:{mx:2}}),s.jsxs(d,{variant:"body2",color:"text.secondary",children:["Last saved: ",B.lastSave.toLocaleTimeString()]})]})]}),z&&s.jsxs(a,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[s.jsx(v,{variant:"outlined",startIcon:s.jsx(S,{}),onClick:()=>A("export","Export Data","Download all your SeaBorne data as a backup file?"),children:"Export"}),s.jsx(v,{variant:"outlined",startIcon:s.jsx(k,{}),onClick:()=>A("import","Import Data","Import data from a backup file? This will replace all current data."),children:"Import"}),s.jsx(v,{variant:"outlined",startIcon:B.saving?s.jsx(D,{size:16}):s.jsx(l,{}),onClick:N,disabled:B.saving,children:B.saving?"Saving...":"Force Save"})]}),s.jsxs(C,{open:T.open,maxWidth:"sm",fullWidth:!0,children:[s.jsx(q,{children:T.title}),s.jsx(I,{children:s.jsx(d,{children:T.message})}),s.jsxs(E,{children:[s.jsx(v,{onClick:()=>W({open:!1,type:null,title:"",message:""}),children:"Cancel"}),s.jsx(v,{onClick:()=>{"export"===T.type?(async()=>{try{const e=await $();e.success?W({open:!1,type:null,title:"",message:""}):alert(`Export failed: ${e.error}`)}catch(e){alert(`Export failed: ${e instanceof Error?e.message:"Unknown error"}`)}})():"import"===T.type&&(async()=>{try{const e=await R();e.success||"File selection cancelled"!==e.error&&alert(`Import failed: ${e.error}`)}catch(e){alert(`Import failed: ${e instanceof Error?e.message:"Unknown error"}`)}W({open:!1,type:null,title:"",message:""})})()},variant:"contained",children:"Confirm"})]})]})]})},F=()=>s.jsxs(P,{maxWidth:"lg",children:[s.jsxs(a,{sx:{mb:4},children:[s.jsx(d,{variant:"h4",component:"h1",gutterBottom:!0,children:"About SeaBorne Navigation Suite"}),s.jsx(d,{variant:"body1",color:"text.secondary",children:"Maritime commercial towing and salvage operations platform"})]}),s.jsxs(z,{direction:{xs:"column",md:"row"},spacing:3,children:[s.jsxs(a,{sx:{flex:{xs:1,md:2}},children:[s.jsxs(c,{sx:{p:3,mb:3},children:[s.jsx(d,{variant:"h6",gutterBottom:!0,children:"Project Overview"}),s.jsx(d,{variant:"body1",paragraph:!0,children:"SeaBorne Navigation Suite is a modern web application designed for maritime commercial towing and salvage operations. This application rebuilds and modernizes existing navigation tools with enhanced mobile support and contemporary web technologies."}),s.jsx(d,{variant:"body1",paragraph:!0,children:"The suite provides comprehensive tools for coordinate conversion, mission planning, fleet management, and financial calculations, all optimized for use in maritime environments."})]}),s.jsxs(c,{sx:{p:3},children:[s.jsx(d,{variant:"h6",gutterBottom:!0,children:"Current Phase: Foundation Setup"}),s.jsx(d,{variant:"body1",paragraph:!0,children:"Version 1.0 focuses on modernizing the architecture while preserving all existing functionality. The foundation has been established with:"}),s.jsxs(a,{component:"ul",sx:{mt:2},children:[s.jsx("li",{children:"React 18+ with TypeScript for type safety"}),s.jsx("li",{children:"Redux Toolkit for state management"}),s.jsx("li",{children:"Material-UI for consistent design"}),s.jsx("li",{children:"Progressive Web App capabilities"}),s.jsx("li",{children:"Mobile-first responsive design"}),s.jsx("li",{children:"Local data persistence"})]})]})]}),s.jsxs(a,{sx:{flex:{xs:1,md:1}},children:[s.jsxs(c,{sx:{p:3,mb:3},children:[s.jsx(d,{variant:"h6",gutterBottom:!0,children:"Technology Stack"}),s.jsxs(a,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[s.jsx(t,{label:"React 18",size:"small"}),s.jsx(t,{label:"TypeScript",size:"small"}),s.jsx(t,{label:"Redux Toolkit",size:"small"}),s.jsx(t,{label:"Material-UI",size:"small"}),s.jsx(t,{label:"Vite",size:"small"}),s.jsx(t,{label:"PWA",size:"small"})]})]}),s.jsxs(c,{sx:{p:3,mb:3},children:[s.jsx(d,{variant:"h6",gutterBottom:!0,children:"Version Information"}),s.jsxs(d,{variant:"body2",color:"text.secondary",children:[s.jsx("strong",{children:"Version:"})," 1.0.0-foundation"]}),s.jsxs(d,{variant:"body2",color:"text.secondary",children:[s.jsx("strong",{children:"Build:"})," Development"]}),s.jsxs(d,{variant:"body2",color:"text.secondary",children:[s.jsx("strong",{children:"Last Updated:"})," ",(new Date).toLocaleDateString()]})]}),s.jsx($,{})]})]})]});export{F as default};
